<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>从睡眠解锁闪屏聊起，聊聊令人哭笑不得的 Mac 键盘 - Sonatta: 生活小栈</title>
<link rel="shortcut icon" href="https://kokurasona.github.io/favicon.ico">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.2.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css">
<link rel="stylesheet" href="https://kokurasona.github.io/media/css/tailwind.css">
<link rel="stylesheet" href="https://kokurasona.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="从睡眠解锁闪屏聊起，聊聊令人哭笑不得的 Mac 键盘 - Sonatta: 生活小栈 - Atom Feed" href="https://kokurasona.github.io/atom.xml">

    

  <meta name="description" content="前言
前些天，早就对 Mac 垂涎三尺的室友终于痛下决心购入了一台跟我同款的 M1 MacBook Air，没想到在使用一段时间后发现了一个奇怪的问题：正常来说，在 MacBook 进入睡眠的情况下，由于此时 Touch ID 不工作，需要..." />
  <meta property="og:title" content="从睡眠解锁闪屏聊起，聊聊令人哭笑不得的 Mac 键盘 - Sonatta: 生活小栈">
  <meta property="og:description" content="前言
前些天，早就对 Mac 垂涎三尺的室友终于痛下决心购入了一台跟我同款的 M1 MacBook Air，没想到在使用一段时间后发现了一个奇怪的问题：正常来说，在 MacBook 进入睡眠的情况下，由于此时 Touch ID 不工作，需要..." />
  <meta property="og:type" content="articles">
  <meta property="og:url" content="https://kokurasona.github.io/post/sZtZMNPQt/" />
  <meta property="og:image" content="https://kokurasona.github.io/images/avatar.png">
  <meta property="og:image:height" content="630">
  <meta property="og:image:width" content="1200">
  <meta name="twitter:title" content="从睡眠解锁闪屏聊起，聊聊令人哭笑不得的 Mac 键盘 - Sonatta: 生活小栈">
  <meta name="twitter:description" content="前言
前些天，早就对 Mac 垂涎三尺的室友终于痛下决心购入了一台跟我同款的 M1 MacBook Air，没想到在使用一段时间后发现了一个奇怪的问题：正常来说，在 MacBook 进入睡眠的情况下，由于此时 Touch ID 不工作，需要...">
  <meta name="twitter:card" content="summary_large_image">
  <link rel="canonical" href="https://kokurasona.github.io/post/sZtZMNPQt/">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css">
 
  
    <link rel="stylesheet" href="https://kokurasona.github.io/media/css/prism-atom-dark.css">
  

  
</head>

<body>
  <div class="antialiased flex flex-col min-h-screen" id="app">
    <a href="https://kokurasona.github.io" class="fixed top-0 left-0 mt-4 bg-black text-white dark:text-gray-700 dark:bg-yellow-50 dark:hover:bg-black dark:hover:text-white inline-flex p-2 pl-8 hover:text-gray-700 hover:bg-yellow-50 font-bold z-10 transition-fast animated fadeInLeft">
      Sonatta: 生活小栈
    </a>
    <div class="max-w-4xl w-full mx-auto">
      <div class="shadow-box bg-white dark:bg-gray-600 rounded-lg pt-32 md:pt-64 px-4 md:px-8 pb-8 animated fadeIn mb-8">
        <h1 class="text-5xl font-semibold leading-normal pb-8 mb-8 border-b-8 border-gray-700">
          从睡眠解锁闪屏聊起，聊聊令人哭笑不得的 Mac 键盘
        </h1>
        
        <div class="mb-8 flex flex-wrap">
          <div class="text-gray-400 text-sm mr-4">2023-06-13 · 11 min read</div>
          
            <a href="https://kokurasona.github.io/tag/za-tan/" class="text-gray-700 text-sm border-b-2 border-dotted border-gray-200 hover:border-gray-600 transition-all duration-100 inline-flex mr-2">
              <i class="ri-hashtag"></i>
              杂谈
            </a>
          
            <a href="https://kokurasona.github.io/tag/mac/" class="text-gray-700 text-sm border-b-2 border-dotted border-gray-200 hover:border-gray-600 transition-all duration-100 inline-flex mr-2">
              <i class="ri-hashtag"></i>
              Mac
            </a>
          
        </div>
        <div class="markdown mb-8" v-pre>
          <h3 id="前言">前言</h3>
<p>前些天，早就对 Mac 垂涎三尺的室友终于痛下决心购入了一台跟我同款的 M1 MacBook Air，没想到在使用一段时间后发现了一个奇怪的问题：正常来说，在 MacBook 进入睡眠的情况下，由于此时 Touch ID 不工作，需要先「按下」Touch ID 键，此时 Touch ID 激活，识别指纹，解锁电脑。这个逻辑链条是非常清晰的，但是我室友的 MacBook 在按下 Touch ID 后，屏幕会先亮起，然后很快黑屏然后再亮起（视觉上看起来就像是“闪屏”），需要再将手指放上去再次识别后才能解锁。</p>
<p>很奇怪是不是？因为是同款，我也在我电脑上试了试，并没有发现这种奇怪的情况。为了搞明白到底是什么情况，我们开始了一番探索。</p>
<h3 id="软件问题">软件问题？</h3>
<p>首先想到的自然是 Mac 自从 Bug Sur 开始层出不穷的软件 bug 导致的，重装解决 99% 的问题，我直接让室友重装系统，但是在一个下午的重装之后，该问题依旧存在，我们只好寄希望于万能的互联网了。</p>
<p>正所谓遇事不决先百度，我们找到了许多类似的案例，比如这个：<a href="https://discussionschinese.apple.com/thread/251977897">MacBook Pro 16寸唤醒屏幕时会闪一次屏幕</a>，根据时间和描述容易推断得知这位朋友的 MacBook 型号应该是 2019 年 11 月发布的那款 16 寸的 MacBook Pro（也就是 M1 芯片发布之前发布的最后那款剪刀脚键盘的 MacBook Pro），然而下面的回复却只有用“万能”的安全模式启动或者更新系统解决云云。自然，这些方法也无法解决这个问题。</p>
<p>当我一边痛骂 bugOS 一边继续找解决方法时，又在苹果论坛找到了同样提到该问题的帖子：<a href="https://discussionschinese.apple.com/thread/96208">唤醒MacBook pro屏幕会闪动</a>，下面同样也是一些没有用的通用解决方案（无非也就是重置 SMC，NVRAM 等），但是在无意间，我注意到了帖子的发布时间：2016 年 12 月，要知道万恶的 Bug Sur 发布时间可是 2020 年，2016 年还是 Sierra，当年的 macOS bug 不像如今这么多。况且从另一个方面讲，2016 年就有的软件 bug，在 2023 年还没有修复，可能性也很小。<br>
<img src="https://kokurasona.github.io/post-images/1686646299995.png" alt="" loading="lazy"><br>
正在我一筹莫展之际，室友搜到了一篇<a href="https://www.xiaohongshu.com/explore/6369e8400000000008011e1b">小红书</a>上的教程，误打误撞的发现了问题所在。<br>
<img src="https://kokurasona.github.io/post-images/1686646323009.png" alt="" loading="lazy"></p>
<h3 id="硬件问题">硬件问题</h3>
<p>根据这位朋友所说，这个问题完全是用户自己的操作问题，然后给出了一些乍看之下似乎很有道理的解释。但是只要简单想想就知道，倘若真的是用户自己的操作问题，那么为什么同样的操作，在我的机器上却不会复现这个问题呢？直言不讳的说，我认为这位朋友的结论是纯粹的扯淡。<br>
<img src="https://kokurasona.github.io/post-images/1686646336892.png" alt="" loading="lazy"><br>
但是，虽然给出的结论是完全错误的，这并不妨碍其中包含有价值的内容，这位朋友提出的多次触发问题提醒了我们——Mac 上的这颗 Touch ID 按键，同时也兼顾了锁屏的功能。也就是说，难道在手指按下的过程中，先触发了解锁功能，然后又再次被“按下”。触发了锁屏功能？这也很符合这个问题的实际表现，即“闪屏”。</p>
<p>室友接下来的发现再次印证了这个猜测：在他的机器上，用手指按压 Touch ID 按键边缘的时候，这个问题没有出现。</p>
<p>一时间，我如醍醐灌顶——也就是说，这很可能是一个硬件设计缺陷。之前的种种线索都连了起来：无论是第一个案例中的 19 款 16 寸 MacBook Pro，还是 16 年发布的第二个帖子（也就是说，他的 MacBook 大概率是 2016 年发布的第一款搭载 Touch ID 的 MacBook Pro），以及我室友的 M1 MacBook Air，都是采用了相同的 Touch ID 按键设计！这个按键设计出现在 2016 至 2020 年间所有搭载 Touch ID 的 MacBook 机型，甚至 13 寸 的 MacBook Pro 至今还在沿用这个设计。也就是说，大概率所有采用这个设计的 Touch ID 都有概率遇到双触发问题，这应该是一个设计缺陷。令人疑惑的是，我居然没有在网上看到任何类似的观点，这就是创作本文的其中一个原因。</p>
<p>而从 21 年发布的 MacBook Pro 起，苹果换用了类似于 Magic Keyboard 上的 Touch ID 按键设计，我询问多位使用新款 Touch ID 按键的朋友，均表示没有遇到这种问题，所以我猜测这个设计缺陷应该只存在于老款 Touch ID 上。当然，可能是样本量太少，如果你用新款按键也会遇到这个问题，欢迎联系我。</p>
<h3 id="键盘与理念之争">键盘与理念之争</h3>
<p>接下来顺便聊聊 Mac 的键盘。</p>
<p>相信熟悉 Mac 的朋友都知道苹果从 16 年开始对 MacBook Pro 的许多设计进行了一次大的调整，包括但不限于：换掉了备受赞誉的 MagSafe 充电口和其他接口，全面拥抱雷电接口、将 Function 键区改成了 Touch Bar、以及，最饱受诟病的：从剪刀脚键盘换成了蝶式键盘。<br>
<img src="https://kokurasona.github.io/post-images/1686646490960.png" alt="" loading="lazy"><br>
这些改动都饱受争议。例如 Touch Bar，我甚至不知道其存在的意义与作用到底为何，就如同我不知道如今没有 Face ID 却做成刘海屏的 MacBook 意义在哪里。但是，如果只是 Touch Bar 或是全雷电接口的话，苹果本可以继续一意孤行，直到强迫用户适应它们，正如他们曾经做的那样。但是，真正强迫苹果做出改变的，是蝶式键盘。</p>
<p>蝶式键盘出现的那一刻，口碑便极度两极分化。对于苹果来说，也许 Touch Bar 和全雷电接口是出于商业上的考量，为变而变，但是只有蝶式键盘，我敢说绝对是苹果的得意之作。蝶式键盘是富有「果味」的产品，它在一定程度上反映了 Jony Ive 与苹果的设计理念：纤薄。在 Jony Ive 时代，苹果始终以纤薄为美。</p>
<p>而同样也是蝶式键盘，将苹果拖下泥潭，四年迭代四次，花费了无数人力和财力，最终，同样是出于商业上的考量，20 年苹果宣判了蝶式键盘的死刑，21 年，实体 Function 键和 MagSafe 悉数回归，就这样，苹果一人孤舞了足足 5 年后，最终又回到了原点。22 年，Jony Ive 正式与苹果解除合作关系，Ive 时代就这样终结了。</p>
<p>这次的失败实际上也反映了后 Ive 时代的设计理念与现实之间不可调节的矛盾：一如 Intel 芯片的 MacBook、一如 Apple Watch Edition，当然，还有蝶式键盘。</p>
<p>不破不立，对于前两个失败的设计，苹果已经交出了答卷：M 芯片的 MacBook，以及 Apple Watch Ultra。而键盘，剪刀脚未必是最终答案，也许苹果会带着全新设计的键盘归来，一如既往。毕竟，苹果是一家记仇的公司。</p>
<h3 id="稀缺的第三方键盘市场">稀缺的第三方键盘市场</h3>
<p>最后说说最近遇到的一个问题，即 Mac 的第三方键盘。</p>
<p>即便一拖再拖，最终还是到了给 Mac 挑一套舒服外设的时候。作为坚定的薄膜键盘拥簇，我本来以为键盘这种东西最多一百块钱就可以了事，但是我实在是没想到，这么多年了，市面上居然几乎没有真正意义上的 Mac 第三方键盘。这里要点名批评某 Keychron K2，整天铺天盖地的推荐，说什么最适合 Mac 的键盘，看到我都觉得机械键盘也不是不能用的时候，点进去一看，连键位都完全不一样，活生生的通用键位，这也好意思大言不惭地叫最适合 Mac 的键盘？我都不知道这些人是怎么好意思推荐的，难道诸位都是买 Mac 装 Windows？</p>
<p>在看了一堆“专为 Mac 设计”的通用键位键盘后，发现只有罗技家的 MX Keys for Mac 是正儿八经的 Mac 键位，考虑到我个人不喜欢小键盘，所以 MX Keys Mini for Mac 就是最适合的选择……直到我看了一眼价格，这个价格都能直接买到苹果官方的全新 Magic Keyboard 了。在下实在是囊中羞涩，于是我又再次陷入了纠结。</p>
<p>结果在一次偶然的机会，闲鱼给我推了一代 Magic Keyboard，说真的，要不是闲鱼推送，作为一个老果粉，我都快忘了还有这玩意。简单查了一下发现非常符合我的需求（毕竟就是官方键盘……），干电池供电设计对我来说更是加分项。于是我在闲鱼上花了 80 大洋淘来了 这么一把<s>女生自用99新</s>老古董，揭开基本要与键盘融为一体的战损键盘膜并简单擦洗后，一把成色几乎全新的键盘出现在了我的面前（在这里墙裂感谢这些为了我们这些二手用户考虑而每天贴膜带壳使用的好心人）。如果你跟我需求差不多的话真的可以考虑一下，我是真的觉得香。<br>
<img src="https://kokurasona.github.io/post-images/1686646520894.png" alt="" loading="lazy"><br>
关于 Mac 第三方键盘问题，这里推荐少数派的一篇文章：<a href="https://sspai.com/post/79608">找一把完美适配 macOS 的第三方键盘，为什么那么难？</a></p>
<h3 id="尾巴游离于-apple-生态圈边缘的-mac-与个人计算终端的未来">尾巴：游离于 Apple 生态圈边缘的 Mac 与个人计算终端的未来</h3>
<p>如果说苹果产品线里我最喜欢哪个产品，那一定是 Mac，独特的体验和对细节的把控在第一次上手后就让我印象深刻。然而，笔记本电脑作为上一个世代的个人计算终端，在如今已然没有那么受重视，无论是 Windows on Arm 的惨淡，还是 macOS 如今的 bug 百出，似乎都预示着它们已然跌入一个困局。倘若你深度体验过苹果构建出来的生态圈，你就能明显感觉到 Mac 早已不再位于核心位置，而是游离于生态的边缘，若即若离。而随着下一个世代的到来，手机是否也会有一天消失在普罗大众的视野中呢，这不禁让人畅想下一代计算终端的到来。站在时代的转折点上，实在是令人又紧张又激动。</p>
<p>写这篇文章的时候，正值 2023 年的 WWDC 举办期间，苹果已然交出了一份答卷，然而这套考题并没有标准答案，苹果的 Vision Pro 会成功吗，也许未必。毕竟在道路尚不明晰的当下，就连苹果也只能摸黑前行。最大的电池问题还没有解决，2 小时的续航根本不堪一用，昂贵的售价也让普通消费者望而却步。或许这款产品最大的意义也许在于其“存在”。在一片凝固的沉郁之中，掀起一阵小小的波澜，试图重现曾经那个百花齐放的时代。</p>

        </div>
        <!-- Share to Twitter, Weibo, Telegram -->
        <div class="flex items-center">
          <div class="mr-4 flex items-center">
            <i class="ri-share-forward-line text-gray-500"></i>
          </div>
          <div class="px-4 cursor-pointer text-blue-500 hover:bg-blue-100 dark:hover:bg-gray-600 inline-flex" @click="shareToTwitter">
            <i class="ri-twitter-line"></i>
          </div>
          <div class="px-4 cursor-pointer text-red-500 hover:bg-red-100 dark:hover:bg-gray-600 inline-flex" @click="shareToWeibo">
            <i class="ri-weibo-line"></i>
          </div>
          <div class="px-4 cursor-pointer text-indigo-500 hover:bg-indigo-100 dark:hover:bg-gray-600 inline-flex" @click="shareToTelegram">
            <i class="ri-telegram-line"></i>
          </div>
        </div>
      </div>

      

      

      <footer class="py-12 text-center px-4 md:px-0" v-pre>
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
</footer>
    </div>

    <!-- TOC Container -->
    <div class="fixed right-0 bottom-0 mb-16 mr-4 shadow w-8 h-8 rounded-full flex justify-center items-center z-10 cursor-pointer bg-white dark:bg-gray-500 dark:text-gray-200 hover:shadow-lg transition-all animated fadeInRight" @click="showToc = true">
      <i class="ri-file-list-line"></i>
    </div>

    <div class="fixed right-0 top-0 bottom-0 overflow-y-auto w-64 bg-white dark:bg-gray-800 p-4 border-l border-gray-100 dark:border-gray-600 z-10 transition-fast" :class="{ '-mr-64': !showToc }">
      <div class="flex mb-4 justify-end">
        <div class="w-8 h-8 inline-flex justify-center items-center rounded-full cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-600 transition-fast" @click="showToc = false">
          <i class="ri-close-line text-lg"></i>
        </div>
      </div>
      <div class="post-toc-container">
        <ul class="markdownIt-TOC">
<li>
<ul>
<li>
<ul>
<li><a href="#%E5%89%8D%E8%A8%80">前言</a></li>
<li><a href="#%E8%BD%AF%E4%BB%B6%E9%97%AE%E9%A2%98">软件问题？</a></li>
<li><a href="#%E7%A1%AC%E4%BB%B6%E9%97%AE%E9%A2%98">硬件问题</a></li>
<li><a href="#%E9%94%AE%E7%9B%98%E4%B8%8E%E7%90%86%E5%BF%B5%E4%B9%8B%E4%BA%89">键盘与理念之争</a></li>
<li><a href="#%E7%A8%80%E7%BC%BA%E7%9A%84%E7%AC%AC%E4%B8%89%E6%96%B9%E9%94%AE%E7%9B%98%E5%B8%82%E5%9C%BA">稀缺的第三方键盘市场</a></li>
<li><a href="#%E5%B0%BE%E5%B7%B4%E6%B8%B8%E7%A6%BB%E4%BA%8E-apple-%E7%94%9F%E6%80%81%E5%9C%88%E8%BE%B9%E7%BC%98%E7%9A%84-mac-%E4%B8%8E%E4%B8%AA%E4%BA%BA%E8%AE%A1%E7%AE%97%E7%BB%88%E7%AB%AF%E7%9A%84%E6%9C%AA%E6%9D%A5">尾巴：游离于 Apple 生态圈边缘的 Mac 与个人计算终端的未来</a></li>
</ul>
</li>
</ul>
</li>
</ul>

      </div>
    </div>

    <!-- Back to top -->
    <div class="fixed right-0 bottom-0 mb-4 mr-4 shadow w-8 h-8 rounded-full flex justify-center items-center z-10 cursor-pointer bg-white hover:shadow-lg transition-all dark:bg-gray-500 dark:text-gray-200" @click="backToUp" v-show="scrolled">
      <i class="ri-arrow-up-line"></i>
    </div>
  </div>

  <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
  <!-- Background of PhotoSwipe. 
        It's a separate element as animating opacity is faster than rgba(). -->
  <div class="pswp__bg">
  </div>
  <!-- Slides wrapper with overflow:hidden. -->
  <div class="pswp__scroll-wrap">
    <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
    <div class="pswp__container">
      <div class="pswp__item">
      </div>
      <div class="pswp__item">
      </div>
      <div class="pswp__item">
      </div>
    </div>
    <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
    <div class="pswp__ui pswp__ui--hidden">
      <div class="pswp__top-bar">
        <!--  Controls are self-explanatory. Order can be changed. -->
        <div class="pswp__counter">
        </div>
        <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
        <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
        <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
        <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
        <!-- element will get class pswp__preloader--active when preloader is running -->
        <div class="pswp__preloader">
          <div class="pswp__preloader__icn">
            <div class="pswp__preloader__cut">
              <div class="pswp__preloader__donut">
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
        <div class="pswp__share-tooltip">
        </div>
      </div>
      <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
      </button>
      <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
      </button>
      <div class="pswp__caption">
        <div class="pswp__caption__center">
        </div>
      </div>
    </div>
  </div>
</div>

  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script src="https://kokurasona.github.io/media/scripts/main.js"></script>
  
  <!-- Code Highlight -->
  
    <script src="https://kokurasona.github.io/media/prism.js"></script>
    <script>
      Prism.highlightAll()
    </script>
  

  <script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>
  <script>
    //拿到预览框架，也就是上面的html代码
    var pswpElement = document.querySelectorAll('.pswp')[0];
    //定义图片数组变量
    var imgitems;
    /**
    * 用于显示预览界面
    * @param index 图片数组下标
    */
    function viewImg(index) {
      //其它选项这里不做过多阐述，详情见官网
      var pswpoptions = {
        index: parseInt(index, 10), // 开始幻灯片索引。0是第一张幻灯片。必须是整数，而不是字符串。
        bgOpacity: 0.7, // 背景透明度，0-1
        maxSpreadZoom: 3, // 缩放级别，不要太大
      };
      //初始化并打开PhotoSwipe，pswpElement对应上面预览框架，PhotoSwipeUI_Default为皮肤，imgitems为图片数组，pswpoptions为选项
      var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, imgitems, pswpoptions);
      gallery.init()
    }
    /**
    * 用于添加图片点击事件
    * @param img 图片元素
    * @param index 所属下标（在imgitems中的位置）
    */
    function addImgClick(img, index) {
      img.onclick = function() {
        viewImg(index)
      }
    }
    /**
    * 轮询所有图片，获取src、width、height等数据，加入imgitems，并给图片元素添加事件
    * 最好在onload中执行该方法，本站因放在最底部，所以直接初始化
    * 异步加载图片可在图片元素创建完成后调用此方法
    */
    function initImg() {
      //重置图片数组
      imgitems = [];
      //查找class:markdown 下的所有img元素并遍历
      var imgs = document.querySelectorAll('.markdown img');
      for (var i = 0; i < imgs.length; i++) {
        var img = imgs[i];
        //本站相册初始为loading图片，真实图片放在data-src
        var ds = img.getAttribute("data-src");
        //创建image对象，用于获取图片宽高
        var imgtemp = new Image();
        //判断是否存在data-src
        if (ds != null && ds.length > 0) {
          imgtemp.src = ds
        } else {
          imgtemp.src = img.src
        }
        //判断是否存在缓存
        if (imgtemp.complete) {
          var imgobj = {
            "src": imgtemp.src,
            "w": imgtemp.width,
            "h": imgtemp.height,
          };
          imgitems[i] = imgobj;
          addImgClick(img, i);
        } else {
          console.log('进来了2')
          imgtemp.index = i;
          imgtemp.img = img;
          imgtemp.onload = function() {
            var imgobj = {
              "src": this.src,
              "w": this.width,
              "h": this.height,
            };
            //不要使用push，因为onload前后顺序会不同
            imgitems[this.index] = imgobj
            //添加点击事件
            addImgClick(this.img, this.index);
          }
        }
      }
    }
    //初始化
    initImg();
  </script>
</body>

</html>